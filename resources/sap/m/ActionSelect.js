/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Select","sap/ui/core/InvisibleText","./library","./ActionSelectRenderer"],function(t,e,o,s){"use strict";var i=t.extend("sap.m.ActionSelect",{metadata:{library:"sap.m",associations:{buttons:{type:"sap.m.Button",multiple:true,singularName:"button"}}}});i.prototype.init=function(){t.prototype.init.call(this);this.getList().addEventDelegate({onfocusin:this.onfocusinList},this)};i.prototype.hasContent=function(){return t.prototype.hasContent.call(this)||!!this.getButtons().length};i.prototype.addContent=function(){var t=sap.ui.getCore(),e=this.getPicker();this.getButtons().forEach(function(o){e.addContent(t.byId(o))})};i.prototype._onBeforeRenderingPopover=function(){t.prototype._onBeforeRenderingPopover.call(this);this._updateTutorMessage()};i.prototype.onAfterRenderingPicker=function(){t.prototype.onAfterRenderingPicker.call(this);var e=this.getPicker(),o=this.getRenderer();e.addStyleClass(o.CSS_CLASS+"Picker");e.addStyleClass(o.ACTION_SELECT_CSS_CLASS+"Picker");e.addStyleClass(o.ACTION_SELECT_CSS_CLASS+"Picker-CTX")};i.prototype.createPickerCloseButton=function(){};i.prototype.removeButton=function(t){var e=this.getPicker();if(e){if(typeof t==="number"){t=this.getButtons()[t]}e.removeContent(t)}return this.removeAssociation("buttons",t)};i.prototype.removeAllButtons=function(){var t=this.getPicker();if(t){this.getButtons().forEach(function(e){t.removeContent(e)})}return this.removeAllAssociation("buttons")};i.prototype.onsaptabprevious=function(t){var e=this.getButtons(),o=this.getPicker(),s;if(t.isMarked()||!this.getEnabled()){return}t.setMarked();if(o&&o.isOpen()&&e.length>0){for(s=e.length-1;s>=0;s--){if(sap.ui.getCore().byId(e[s]).getEnabled()){sap.ui.getCore().byId(e[s]).focus();t.preventDefault();break}}}};i.prototype.onsaptabnext=function(t){var e=this.getButtons(),o=this.getPicker(),s;if(t.isMarked()||!this.getEnabled()){return}t.setMarked();if(o&&o.isOpen()&&e.length>0){for(s=0;s<e.length;s++){if(sap.ui.getCore().byId(e[s]).getEnabled()){sap.ui.getCore().byId(e[s]).focus();t.preventDefault();break}}}};i.prototype.onsapfocusleave=function(e){var o=this.getButtons();var s=o.indexOf(e.relatedControlId)==-1;if(s){t.prototype.onsapfocusleave.apply(this,arguments)}this._toggleListFocusIndication(true)};i.prototype.onfocusinList=function(t){if(document.activeElement!==this.getList().getDomRef()){this.focus()}};i.prototype.onfocusin=function(){t.prototype.onfocusin.apply(this,arguments);this._toggleListFocusIndication(false)};i.prototype._toggleListFocusIndication=function(t){var e=this.getSelectedItem();if(this.isOpen()&&e){e.$().toggleClass("sapMActionSelectItemWithoutFocus",t)}};i.prototype._updateTutorMessage=function(){var t=this.getPicker(),o=t.getAriaLabelledBy(),s=!!this.getButtons().length,i;if(!this._sTutorMessageId){this._sTutorMessageId=this._getTutorMessageId();this._oTutorMessageText=new e(this._sTutorMessageId,{text:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("ACTION_SELECT_TUTOR_MESSAGE")}).toStatic()}i=o.indexOf(this._sTutorMessageId)===-1;if(i&&s){t.addAriaLabelledBy(this._sTutorMessageId)}else{if(!s){t.removeAriaLabelledBy(this._sTutorMessageId)}}};i.prototype._getTutorMessageId=function(){return this.getId()+"-tutorMessage"};i.prototype.exit=function(){if(this._oTutorMessageText){this._oTutorMessageText.destroy();this._oTutorMessageText=null}};return i});