/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/IntervalTrigger","sap/ui/thirdparty/jquery"],function(t,i){"use strict";sap.ui.base.EventProvider.extend("sap.m._Ios7",{constructor:function(){var t=sap.ui.Device.os.ios&&sap.ui.Device.os.version>=7&&sap.ui.Device.os.version<8&&sap.ui.Device.browser.name==="sf";sap.ui.base.EventProvider.apply(this);if(!t){return}this._bIntervallAttached=false;this._bInputIsOpen=false;this._bNavigationBarEventFired=false;var e=window.orientation===90||window.orientation===-90;if(e){this._attachNavigationBarPolling()}sap.ui.Device.orientation.attachHandler(this._onOrientationChange,this);this._onFocusin=i.proxy(this._onFocusin,this);document.addEventListener("focusin",this._onFocusin,true);this._onFocusout=i.proxy(this._onFocusout,this);document.addEventListener("focusout",this._onFocusout,true)}});sap.m._Ios7.prototype.getNavigationBarHeight=function(){if(!this._bNavigationBarEventFired){return 0}return this._iNavigationBarHeight};sap.m._Ios7.prototype._attachNavigationBarPolling=function(){if(!sap.ui.Device.system.phone||this._bIntervallAttached){return}t.addListener(this._detectNavigationBar,this);this._bIntervallAttached=true};sap.m._Ios7.prototype._detachNavigationBarPolling=function(){if(!sap.ui.Device.system.phone||!this._bIntervallAttached){return}t.removeListener(this._detectNavigationBar,this);this._bIntervallAttached=false};sap.m._Ios7.prototype._detectNavigationBar=function(){var t=window.outerHeight-window.innerHeight;if(t===0||this._bInputIsOpen||this._bNavigationBarEventFired){this._iPreviousHeight=null;return}if(this._iPreviousHeight===window.innerHeight){window.scrollTo(0,0);var i=window.outerHeight-window.innerHeight;if(t!==i){return}this._iNavigationBarHeight=t;this._bNavigationBarEventFired=true;this.fireEvent("navigationBarShownInLandscape",{barHeight:t});this._detachNavigationBarPolling();this._iPreviousHeight=null}else{this._iPreviousHeight=window.innerHeight}};sap.m._Ios7.prototype.destroy=function(){sap.ui.base.EventProvider.prototype.destroy.apply(this,arguments);document.removeEventListener("focusin",this._onFocusin,true);document.removeEventListener("focusout",this._onFocusout,true)};sap.m._Ios7.prototype._onFocusin=function(t){var i=t.target.tagName;if(!sap.m._Ios7._rTagRegex.test(i)){return}this._inputTarget=t.target;this._detachNavigationBarPolling();this._bInputIsOpen=true;this.fireEvent("inputOpened")};sap.m._Ios7._rTagRegex=/INPUT|TEXTAREA|SELECT/;sap.m._Ios7.prototype._onFocusout=function(t){var i=t.srcElement.tagName,e=t.relatedTarget,n=e&&e.getAttribute("readonly")===null&&e.getAttribute("disabled")===null?e.tagName:"";if(sap.m._Ios7._rTagRegex.test(i)&&!sap.m._Ios7._rTagRegex.test(n)){window.scrollTo(0,0);if(window.orientation===90||window.orientation===-90){this._attachNavigationBarPolling()}this._bInputIsOpen=false;this.fireEvent("inputClosed")}};sap.m._Ios7.prototype._onOrientationChange=function(t){var i=t.landscape;window.scrollTo(0,0);this._bNavigationBarEventFired=false;if(this._bInputIsOpen&&this._inputTarget&&this._inputTarget.blur){this._inputTarget.blur()}else if(i){this._attachNavigationBarPolling()}else if(!i){this._detachNavigationBarPolling()}};var e=new sap.m._Ios7;return e},true);