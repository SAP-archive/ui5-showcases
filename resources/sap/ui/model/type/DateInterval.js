/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/format/DateFormat","sap/ui/model/CompositeType","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/thirdparty/jquery"],function(t,e,i,a,o,s){"use strict";var r=e.extend("sap.ui.model.type.DateInterval",{constructor:function(){e.apply(this,arguments);this.sName="DateInterval";this.bUseInternalValues=true}});r.prototype.formatValue=function(t,e){if(!Array.isArray(t)){throw new i("Cannot format date interval: "+t+" is expected as an Array but given the wrong format")}switch(this.getPrimitiveType(e)){case"string":case"any":if(!t[0]||!t[1]&&!this.oFormatOptions.singleIntervalValue){return""}if(this.oInputFormat){t=t.slice(0,2);t.forEach(function(e,a){if(this.oFormatOptions.source.pattern=="timestamp"){if(typeof e!="number"){if(isNaN(e)){throw new i("Cannot format date: "+e+" is not a valid Timestamp")}else{e=parseInt(e)}}e=new Date(e)}else{e=this.oInputFormat.parse(e);if(e==null){throw new i("Cannot format date: "+e+" has the wrong format")}}t[a]=e}.bind(this))}return this.oOutputFormat.format(t);default:throw new i("Don't know how to format Date to "+e)}};r.prototype.parseValue=function(t,e){var i;function o(t){var e=sap.ui.getCore().getLibraryResourceBundle();throw new a(e.getText(t+".Invalid"))}switch(this.getPrimitiveType(e)){case"string":if(t===""){return[null,null]}i=this.oOutputFormat.parse(t);if(!i[0]||!i[1]&&!this.oFormatOptions.singleIntervalValue){o(this.sName)}if(this.oInputFormat){i.forEach(function(t,e){if(this.oFormatOptions.source.pattern=="timestamp"){t=t.getTime()}else{t=this.oInputFormat.format(t)}i[e]=t}.bind(this))}return i;default:throw new a("Don't know how to parse Date from "+e)}};r.prototype.validateValue=function(t){if(this.oConstraints){var e=sap.ui.getCore().getLibraryResourceBundle(),i=[],a=[];if(this.oInputFormat&&this.oFormatOptions.source.pattern!="timestamp"){t=t.slice(0,2);t.forEach(function(e,i){e=this.oInputFormat.parse(e);t[i]=e}.bind(this))}Object.keys(this.oConstraints).forEach(function(o){var s=this.oConstraints[o];var r=true;switch(o){case"minimum":if(this.oFormatOptions.singleIntervalValue&&t[1]===null){if(t[0]<s){r=false}}else if(t[0]<s||t[1]<s){r=false}if(r===false){i.push("minimum");a.push(e.getText("Date.Minimum",[s]))}break;case"maximum":if(this.oFormatOptions.singleIntervalValue&&t[1]===null){if(t[0]>s){r=false}}else if(t[0]>s||t[1]>s){r=false}if(r===false){i.push("maximum");a.push(e.getText("Date.Maximum",[s]))}}}.bind(this));if(i.length>0){throw new o(this.combineMessages(a),i)}}};r.prototype.setFormatOptions=function(t){this.oFormatOptions=t;this._createFormats()};r.prototype._handleLocalizationChange=function(){this._createFormats()};r.prototype._createFormats=function(){var e=this.oFormatOptions.source;this.oFormatOptions.interval=true;this.oOutputFormat=t.getDateInstance(this.oFormatOptions);if(e){if(s.isEmptyObject(e)){e={pattern:"yyyy-MM-dd"}}this.oInputFormat=t.getDateInstance(e)}};return r});