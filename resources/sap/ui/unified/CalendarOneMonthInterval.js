/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/unified/calendar/CustomMonthPicker","sap/ui/unified/calendar/CalendarUtils","sap/ui/unified/calendar/CalendarDate","sap/ui/unified/Calendar","./library","sap/ui/unified/CalendarDateInterval","sap/ui/unified/calendar/OneMonthDatesRow"],function(t,e,a,i,o,n,r){"use strict";var s=n.extend("sap.ui.unified.CalendarOneMonthInterval",{});s.prototype.init=function(){n.prototype.init.apply(this,arguments);this._bShowOneMonth=true};s.prototype._getCalendarPicker=function(){var a=this.getAggregation("calendarPicker");if(!a){a=new t(this.getId()+"--Cal");a.setPopupMode(true);a.attachEvent("select",function(){var t=this._getCalendarPicker(),a=t._getFocusedDate(),i=e._getFirstDateOfMonth(a);var o=this.getAggregation("month")[0];this._setStartDate(i);if(o.getMode()<2){i=this._getStartDate()}this._adjustSelectedDate(i,false);this._oFocusDateOneMonth=i;this._closeCalendarPicker(true);this._focusDate(a,false,true)},this);a.attachEvent("cancel",function(t){var e=this._getCalendarPicker(),a=e._getFocusedDate();this._closeCalendarPicker(true);this._oFocusDateOneMonth=a;this._focusDate(a,true);var i=this.getAggregation("header").getDomRef("B1");if(i){i.focus()}},this);this.setAggregation("calendarPicker",a)}return a};s.prototype._createMonth=function(t){return new r(t)};s.prototype._handleFocus=function(t){var i=!!t.getParameter("_outsideBorder"),o=t.getParameter("date"),r=a.fromLocalJSDate(o),s=a.fromLocalJSDate(this.getStartDate()),h=!e._isSameMonthAndYear(r,s),g,c,u;if(i||h){if(e._isLastDateInMonth(r)){this._oFocusDateOneMonth=r}else{this._oFocusDateOneMonth=e._getFirstDateOfMonth(r)}g=r.isBefore(s)?-1:1;c=new a(this._getFocusedDate(),this.getPrimaryCalendarType());u=new a(this._getStartDate(),this.getPrimaryCalendarType());n.prototype._shiftStartFocusDates.call(this,c,u,g)}return n.prototype._handleFocus.apply(this,arguments)};s.prototype._focusDateExtend=function(t,e,a){var i,o;if(!this._oFocusDateOneMonth){return n.prototype._focusDateExtend.apply(this,arguments)}i=this.getAggregation("month")[0];o=this._oFocusDateOneMonth.toLocalJSDate();this._setFocusedDate(this._oFocusDateOneMonth);i._bNoRangeCheck=true;i.setDate(o);i._bNoRangeCheck=false;this._oFocusDateOneMonth=null;return!a};s.prototype._setDisplayMode=function(t){this.getAggregation("month")[0].setMode(t)};s.prototype._shiftStartFocusDates=function(t,e,i){var o=i,n=this.getAggregation("month")[0],r,s;if(o!==0){o=o>0?1:-1}t.setMonth(t.getMonth()+o);e.setYear(t.getYear());e.setMonth(t.getMonth(),t.getDate());this._setFocusedDate(e);this._setStartDate(t,true);r=this.getStartDate();s=a.fromLocalJSDate(r,this.getPrimaryCalendarType());if(this.getMinDate()&&this.getMinDate().getTime()>r.getTime()){s=a.fromLocalJSDate(this.getMinDate(),this.getPrimaryCalendarType())}if(this.getMaxDate()&&this.getMaxDate().getTime()<r.getTime()){s=a.fromLocalJSDate(this.getMaxDate(),this.getPrimaryCalendarType())}n.selectDate(s.toLocalJSDate());if(n.getMode()<2){this.fireSelect()}};s.prototype._adjustSelectedDate=function(t,a){var i=this.getAggregation("month")[0],o;o=a?e._getFirstDateOfMonth(t):t;if(i.getMode&&i.getMode()<2){this._selectDate(o)}};s.prototype._selectDate=function(t){var e=this.getAggregation("month")[0],a=t.toLocalJSDate();this.removeAllSelectedDates();this.addSelectedDate(new sap.ui.unified.DateRange({startDate:a}));e.selectDate(a);this._bDateRangeChanged=undefined};s.prototype._dateMatchesVisibleRange=function(t){return e._isSameMonthAndYear(a.fromLocalJSDate(this.getStartDate()),a.fromLocalJSDate(t))};s.prototype._togglePrevNext=function(t,i){var o=this.getAggregation("header");var n=this._oMaxDate.getYear();var r=this._oMinDate.getYear();var s=this._oMaxDate.getMonth();var h=this._oMinDate.getMonth();var g=e._getFirstDateOfMonth(t);var c=new a(g),u,l;c.setMonth(c.getMonth()+1);u=g.getYear();l=g.getMonth();if(u<r||u==r&&(!i||l<=h)){o.setEnabledPrevious(false)}else{o.setEnabledPrevious(true)}u=c.getYear();l=c.getMonth();if(u>n||u==n&&(!i||l>s)){o.setEnabledNext(false)}else{o.setEnabledNext(true)}};s.prototype._setMinMaxDateExtend=function(t){return i.prototype._setMinMaxDateExtend.apply(this,arguments)};return s});